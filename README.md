# ì›ì ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ (Atom State Management Library)

Reactë¥¼ ìœ„í•œ ê°„ë‹¨í•˜ê³  íš¨ìœ¨ì ì¸ ì›ì ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.  
ì„±ëŠ¥ ìµœì í™”ì™€ Reactì˜ Concurrent Featuresë¥¼ ê³ ë ¤í•˜ì—¬ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

## ğŸš€ ì£¼ìš” ê¸°ëŠ¥

- **ì›ì ìƒíƒœ (Atom)**: ìµœì†Œ ë‹¨ìœ„ì˜ ìƒíƒœ ê´€ë¦¬
- **íŒŒìƒ ìƒíƒœ (Derived Atom)**: ë‹¤ë¥¸ ìƒíƒœë¡œë¶€í„° ê³„ì‚°ë˜ëŠ” ìƒíƒœ
- **ë¹„ë™ê¸° ìƒíƒœ (Async Atom)**: Suspenseì™€ Error Boundary ì§€ì›
- **ìë™ ë°°ì¹˜ ì—…ë°ì´íŠ¸**: ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ë¥¼ í™œìš©í•œ ì„±ëŠ¥ ìµœì í™”
- **React 18 í˜¸í™˜**: useSyncExternalStore í™œìš©

## ğŸ“¦ ì„¤ì¹˜ ë° ì‚¬ìš©

```bash
pnpm install
pnpm dev
```

## ğŸ—ï¸ ì›ì ìƒíƒœ(Atom) ì‹œìŠ¤í…œ êµ¬ì¡°

### ì „ì²´ ì•„í‚¤í…ì²˜

```js
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Atom State System                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚    Atom     â”‚      â”‚ DerivedAtom â”‚    â”‚  AsyncAtom  â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚            â”‚                  â”‚                   â”‚          â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                               â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Schedule Update System                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚ pendingUpdates  â”‚  â”‚     Microtask Queue            â”‚â”‚ â”‚
â”‚  â”‚  â”‚   (Set<fn>)     â”‚  â”‚     Promise.resolve()          â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      React ì—°ë™                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚    useAtom      â”‚  â”‚    useSyncExternalStore        â”‚â”‚ â”‚
â”‚  â”‚  â”‚     (Hook)      â”‚  â”‚      (React 18)                â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ êµ¬ì„± ìš”ì†Œ

#### 1. Atom Interface

```typescript
interface Atom<T> {
  _getValue: () => T;
  _setValue: (newValue: T) => void;
  _subscribe: (listener: () => void) => () => void;
}
```

#### 2. ìƒíƒœ íë¦„

```
ì‚¬ìš©ì ì•¡ì…˜ â†’ set(atom, value) â†’ atom._setValue() â†’ scheduleUpdate() 
â†’ Batch Update (Microtask Queue) â†’ êµ¬ë…ì ë¦¬ë Œë”
```

## ğŸ¯ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ê³„ ê³ ë ¤ì‚¬í•­ê³¼ ê¸°ìˆ ì  ì„ íƒ

### 1. ì„±ëŠ¥ ìµœì í™” ìš°ì„  ì„¤ê³„

#### ìë™ ë°°ì¹˜ ì—…ë°ì´íŠ¸ ì‹œìŠ¤í…œ

- **ë¬¸ì œ**: ë™ê¸°ì  ìƒíƒœ ì—…ë°ì´íŠ¸ë¡œ ì¸í•œ ê³¼ë„í•œ ë¦¬ë Œë”ë§  
- **í•´ê²°ì±…**: ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íë¥¼ í™œìš©í•œ ë°°ì¹˜ ì²˜ë¦¬  
- **ì„ íƒ ì´ìœ **: ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ `Promise.resolve()` ì‚¬ìš©  

```typescript
// ë¦¬ë Œë”ë§ì„ ë°°ì¹˜ ì²˜ë¦¬í•˜ì—¬ ì„±ëŠ¥ì„ ìµœì í™”í•˜ëŠ” í•µì‹¬ í•¨ìˆ˜
const scheduleUpdate = (listener: () => void) => {
  pendingUpdates.add(listener);

  if (!isFlushingUpdates) {
    isFlushingUpdates = true;
    Promise.resolve().then(() => {
      const listeners = Array.from(pendingUpdates);
      pendingUpdates.clear();
      isFlushingUpdates = false;
      listeners.forEach(listener => listener());
    });
  }
};
```

#### ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±
- **Set ìë£Œêµ¬ì¡°**: ì¤‘ë³µ ë¦¬ìŠ¤ë„ˆ ì œê±°  
- **ì•½í•œ ì°¸ì¡° íŒ¨í„´**: êµ¬ë… í•´ì œ ì‹œ ìë™ ë©”ëª¨ë¦¬ ì •ë¦¬  
- **ì§€ì—° ê³„ì‚°**: íŒŒìƒ ìƒíƒœ í•„ìš” ì‹œì ì—ë§Œ ê³„ì‚° ìˆ˜í–‰  

### 2. useAtomì˜ React 18 í˜¸í™˜ì„± ê³ ë ¤

#### useSyncExternalStore ì±„íƒ
- **ì´ì „ ë°©ì‹**: `useState` + `useEffect` ì¡°í•© (tearing ë¬¸ì œ ë°œìƒ)  
- **í˜„ì¬ ë°©ì‹**: React 18ì˜ `useSyncExternalStore` í™œìš©  
- **ì¥ì **: Concurrent Rendering í˜¸í™˜, í‹°ì–´ë§ í˜„ìƒ ë°©ì§€  

```typescript
export const useAtom = <T>(atom: Atom<T>) => {
  const value = useSyncExternalStore(
    atom._subscribe,
    atom._getValue
  );
  return value;
};
```

### 3. íƒ€ì… ì•ˆì „ì„±ê³¼ ê°œë°œì ê²½í—˜
- ë‚´ë¶€ APIëŠ” `_` ì ‘ë‘ì‚¬ë¡œ ì€ë‹‰  
- `get`, `set`, `subscribe`, `useAtom`ë§Œ ê³µê°œ  
- TypeScript ê¸°ë°˜ìœ¼ë¡œ ì»´íŒŒì¼ íƒ€ì„ ì•ˆì „ì„± ë³´ì¥  

### 4. í™•ì¥ì„± ê³ ë ¤ ì„¤ê³„
- **ê¸°ë³¸ Atom** â†’ í•µì‹¬ ìƒíƒœ ê´€ë¦¬  
- **íŒŒìƒ Atom** â†’ ê³„ì‚°ëœ ìƒíƒœ ê´€ë¦¬  
- **ë¹„ë™ê¸° Atom** â†’ Suspense/ì—ëŸ¬ ì²˜ë¦¬ ì§€ì›  

---

## ğŸ” ì›ì ìƒíƒœì˜ ê°’ ë¹„êµ ë°©ì‹ê³¼ ìµœì í™”
- `Object.is()`ë¡œ ì •í™•í•œ ë™ë“±ì„± ê²€ì‚¬  
- ì¤‘ë³µ ì—…ë°ì´íŠ¸ ë°©ì§€ (Set ìë£Œêµ¬ì¡° í™œìš©)  
- íŒŒìƒ ìƒíƒœëŠ” ì§€ì—° í‰ê°€(Lazy Evaluation)  
- êµ¬ë… í•´ì œ ì‹œ ìë™ ë©”ëª¨ë¦¬ ì •ë¦¬  

---

## âš›ï¸ Reactì™€ ì—°ë™ ì‹œ ë°œìƒí•œ ë¬¸ì œ ë° í•´ê²° ë°©ë²•
- ê¸°ì¡´ ë°©ì‹(`useState`+`useEffect`) â†’ tearing, ë™ê¸°í™” ë¶ˆì¼ì¹˜ ë¬¸ì œ ë°œìƒ  
- `useSyncExternalStore`ë¡œ í•´ê²° â†’ Concurrent Rendering ëŒ€ì‘ ë° tearing ë°©ì§€  

---
# simple-store-assignment
